<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sauron-Pro Victim Monitoring System</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #2c3e50;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        .architecture-box {
            background: #1e3a2e;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-line;
            margin: 20px 0;
            border: 2px solid #27ae60;
        }
        .code-block {
            background: #1e3a2e;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
            border: 1px solid #27ae60;
        }
        .api-endpoint {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .warning-box {
            background: #e67e22;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-weight: bold;
        }
        .danger-box {
            background: #c0392b;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border: 2px solid #e74c3c;
            font-weight: bold;
        }
        .info-box {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .success-box {
            background: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .critical-box {
            background: #8b0000;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border: 2px solid #ff0000;
            font-weight: bold;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 25px;
        }
        li {
            margin: 5px 0;
        }
        .component-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .component-card {
            border: 1px solid #3498db;
            border-radius: 5px;
            padding: 20px;
            background: #f8f9fa;
        }
        .detection-flow {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .step {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #2c3e50;
            color: white;
        }
        .nav-menu {
            background: #1e3a2e;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #27ae60;
        }
        .nav-menu a {
            color: #ecf0f1;
            text-decoration: none;
            margin-right: 20px;
            padding: 5px 10px;
            border-radius: 3px;
        }
        .nav-menu a:hover {
            background: #27ae60;
        }
        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin: 2px;
        }
        .risk-safe { background: #27ae60; color: white; }
        .risk-suspicious { background: #f39c12; color: white; }
        .risk-dangerous { background: #e67e22; color: white; }
        .risk-law-enforcement { background: #c0392b; color: white; }
        .endpoint-section {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-menu">
            <a href="index.html">← Back to Docs</a>
            <a href="admin-api.html">Admin API</a>
            <a href="security-features.html">Security Features</a>
            <a href="VICTIM_MONITORING_SYSTEM.md">Full Documentation</a>
        </div>

        <h1>🔍 Victim Monitoring System</h1>

        <div class="critical-box">
            ⚠️ <strong>CRITICAL DISTINCTION</strong> ⚠️<br>
            <strong>Customers</strong> = Your paying clients who use the framework<br>
            <strong>Victims</strong> = End users targeted by your customers (potential law enforcement)
        </div>

        <h2>🎯 System Overview</h2>
        <p>The Victim Monitoring System detects when <strong>potential law enforcement agents</strong> or <strong>security researchers</strong> are interacting with your phishing infrastructure. This system provides real-time threat detection and automatic defensive responses.</p>

        <div class="architecture-box">🔍 VICTIM MONITORING ARCHITECTURE

┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   MITM PROXY    │────│  VICTIM MONITOR │────│  RISK ANALYSIS  │
│                 │    │                 │    │                 │
│ • Entry Point   │    │ • Email Track   │    │ • Gov Email     │
│ • IP Capture    │    │ • IP Mapping    │    │ • LE IP Range   │
│ • User Agent    │    │ • Activity Log  │    │ • Tool Detect   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                        │                        │
         └────────────────────────┼────────────────────────┘
                                  │
                    ┌─────────────────┐
                    │  AUTO RESPONSE  │
                    │                 │
                    │ • Block LE      │
                    │ • Alert Admin   │
                    │ • Rate Limit    │
                    │ • Decoy Traffic │
                    └─────────────────┘</div>

        <h2>🚨 Risk Classification</h2>
        <div class="component-grid">
            <div class="component-card">
                <h3><span class="risk-badge risk-safe">SAFE (0)</span></h3>
                <p><strong>Normal victim behavior</strong></p>
                <ul>
                    <li>Standard email domains</li>
                    <li>Regular browsing patterns</li>
                    <li>No automation signatures</li>
                    <li>Consumer IP ranges</li>
                </ul>
            </div>

            <div class="component-card">
                <h3><span class="risk-badge risk-suspicious">SUSPICIOUS (1)</span></h3>
                <p><strong>Some concerning indicators</strong></p>
                <ul>
                    <li>Unusual browsing patterns</li>
                    <li>Technical email domains</li>
                    <li>Rapid form interactions</li>
                    <li>VPN/proxy usage</li>
                </ul>
            </div>

            <div class="component-card">
                <h3><span class="risk-badge risk-dangerous">DANGEROUS (2)</span></h3>
                <p><strong>Multiple red flags detected</strong></p>
                <ul>
                    <li>Security company domains</li>
                    <li>Investigation-style browsing</li>
                    <li>Automation tool signatures</li>
                    <li>Systematic URL testing</li>
                </ul>
            </div>

            <div class="component-card">
                <h3><span class="risk-badge risk-law-enforcement">LAW ENFORCEMENT (3)</span></h3>
                <p><strong>High confidence LE detection</strong></p>
                <ul>
                    <li>.gov/.mil email domains</li>
                    <li>Known LE IP ranges</li>
                    <li>Law enforcement agencies</li>
                    <li>Government network signatures</li>
                </ul>
            </div>
        </div>

        <h2>🔧 API Endpoints</h2>

        <div class="endpoint-section">
            <h3>Security Alerts - High-Risk Victims</h3>
            <div class="api-endpoint">GET /admin/security-alerts</div>
            <p><strong>Purpose:</strong> Get real-time security alerts for law enforcement detection</p>
            <div class="code-block">curl -H "Authorization: Bearer [FIRESTORE_AUTH]" \
     https://your-domain.com/admin/security-alerts</div>

            <p><strong>Response Example:</strong></p>
            <div class="code-block">{
  "timestamp": "2025-08-17T10:30:00Z",
  "alert_count": 3,
  "alerts": [
    {
      "slug": "victim@fbi.gov",
      "risk_level": "LAW_ENFORCEMENT",
      "risk_score": 85,
      "flags": ["gov_email", "law_enforcement"],
      "last_active": "2025-08-17T10:25:00Z",
      "threat_type": "GOVERNMENT_EMAIL",
      "action_taken": "IMMEDIATE_BLOCK"
    }
  ]
}</div>
        </div>

        <div class="endpoint-section">
            <h3>Customer Performance Metrics</h3>
            <div class="api-endpoint">GET /admin/customer-metrics</div>
            <p><strong>Purpose:</strong> Get customer performance data (simplified since we focus on victim monitoring)</p>
            <div class="code-block">curl -H "Authorization: Bearer [FIRESTORE_AUTH]" \
     "https://your-domain.com/admin/customer-metrics?slug=CUSTOMER_SLUG"</div>

            <p><strong>Response Example:</strong></p>
            <div class="code-block">{
  "slug": "customer-abc",
  "performance": "ACTIVE",
  "risk_level": "UNKNOWN",
  "total_visits": 150,
  "security_alerts": 2
}</div>
        </div>

        <div class="endpoint-section">
            <h3>Link Performance Analytics</h3>
            <div class="api-endpoint">GET /admin/link-performance</div>
            <p><strong>Purpose:</strong> Get aggregate performance metrics with victim security data</p>
            <div class="code-block">curl -H "Authorization: Bearer [FIRESTORE_AUTH]" \
     https://your-domain.com/admin/link-performance</div>
        </div>

        <h2>🛡️ Detection Methods</h2>

        <div class="detection-flow">
            <h3>Multi-Layer Detection System</h3>
            <div class="step">
                <strong>Layer 1: Email Domain Analysis</strong>
                <div class="code-block">Government Patterns: .gov, .mil, .police, .fbi, .dhs, .doj</div>
            </div>
            <div class="step">
                <strong>Layer 2: IP Geolocation</strong>
                <div class="code-block">LE IP Ranges: 192.52.178.0/24 (FBI), 149.101.0.0/16 (DHS)</div>
            </div>
            <div class="step">
                <strong>Layer 3: User Agent Analysis</strong>
                <div class="code-block">Tool Signatures: selenium, phantomjs, headless, bot, crawler</div>
            </div>
            <div class="step">
                <strong>Layer 4: Behavioral Patterns</strong>
                <div class="code-block">Investigation Behavior: Rapid testing, systematic probing</div>
            </div>
        </div>

        <h2>⚡ Automatic Response System</h2>

        <table>
            <thead>
                <tr>
                    <th>Threat Type</th>
                    <th>Detection Method</th>
                    <th>Auto Response</th>
                    <th>Risk Score</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Government Email</td>
                    <td>Email domain pattern</td>
                    <td>IMMEDIATE_BLOCK</td>
                    <td>+60</td>
                </tr>
                <tr>
                    <td>Law Enforcement IP</td>
                    <td>CIDR range match</td>
                    <td>IMMEDIATE_BLOCK</td>
                    <td>+70</td>
                </tr>
                <tr>
                    <td>Security Research</td>
                    <td>Tool signatures</td>
                    <td>BLOCK_RECOMMENDED</td>
                    <td>+40</td>
                </tr>
                <tr>
                    <td>Automated Scan</td>
                    <td>Behavior analysis</td>
                    <td>RATE_LIMIT</td>
                    <td>+25</td>
                </tr>
            </tbody>
        </table>

        <h2>🔒 System Architecture</h2>

        <div class="component-grid">
            <div class="component-card">
                <h3>Global Monitor Instance</h3>
                <p><code>monitoring/monitor.go</code></p>
                <ul>
                    <li>Single global VictimMonitor</li>
                    <li>Shared across all packages</li>
                    <li>Automatic initialization</li>
                    <li>Thread-safe operations</li>
                </ul>
            </div>

            <div class="component-card">
                <h3>Victim Detection Engine</h3>
                <p><code>monitoring/victim_monitor.go</code></p>
                <ul>
                    <li>Email/IP correlation</li>
                    <li>Risk scoring algorithms</li>
                    <li>Pattern recognition</li>
                    <li>Real-time analysis</li>
                </ul>
            </div>

            <div class="component-card">
                <h3>MITM Integration</h3>
                <p><code>proxy/mitm.go</code></p>
                <ul>
                    <li>Entry point monitoring</li>
                    <li>Anonymous victim tracking</li>
                    <li>IP address capture</li>
                    <li>User agent analysis</li>
                </ul>
            </div>

            <div class="component-card">
                <h3>Credential Handler</h3>
                <p><code>capture/handler.go</code></p>
                <ul>
                    <li>Email correlation</li>
                    <li>Detailed victim analysis</li>
                    <li>Blocking decisions</li>
                    <li>Alert generation</li>
                </ul>
            </div>
        </div>

        <h2>📊 Dashboard Integration</h2>

        <div class="info-box">
            <strong>Real-time Monitoring:</strong>
            <ul>
                <li><strong>Security Alerts:</strong> Immediate LE detection notifications</li>
                <li><strong>Risk Distribution:</strong> Victim risk level statistics</li>
                <li><strong>Threat Trends:</strong> Investigation pattern analysis</li>
                <li><strong>Blocking Activity:</strong> Automatic response statistics</li>
            </ul>
        </div>

        <h2>🚨 Alert Categories</h2>

        <div class="component-grid">
            <div class="component-card">
                <h3>🏛️ Government Email</h3>
                <p><strong>Threat:</strong> GOVERNMENT_EMAIL</p>
                <p><strong>Action:</strong> IMMEDIATE_BLOCK</p>
                <p>Detects .gov/.mil domains and law enforcement agencies</p>
            </div>

            <div class="component-card">
                <h3>🚔 Law Enforcement IP</h3>
                <p><strong>Threat:</strong> LAW_ENFORCEMENT</p>
                <p><strong>Action:</strong> IMMEDIATE_BLOCK</p>
                <p>Known FBI, DHS, DOJ IP ranges and networks</p>
            </div>

            <div class="component-card">
                <h3>🔬 Security Research</h3>
                <p><strong>Threat:</strong> SECURITY_RESEARCH</p>
                <p><strong>Action:</strong> BLOCK_RECOMMENDED</p>
                <p>Security companies and research institutions</p>
            </div>

            <div class="component-card">
                <h3>🤖 Automated Tools</h3>
                <p><strong>Threat:</strong> AUTOMATED_SCAN</p>
                <p><strong>Action:</strong> RATE_LIMIT</p>
                <p>Bot frameworks and security scanners</p>
            </div>
        </div>

        <h2>⚙️ Configuration Options</h2>

        <div class="code-block">// Add custom government domains
govPatterns := []string{
    `\.gov$`, `\.mil$`, `\.police\.`,
    `\.gov\.uk$`, `\.gov\.au$`, // International
    `YOUR_CUSTOM_PATTERN`,     // Add your intel
}

// Update law enforcement IP ranges  
leRanges := []string{
    "192.52.178.0/24", // FBI
    "149.101.0.0/16",  // DHS  
    "204.248.25.0/24", // DOJ
    "YOUR_INTEL_RANGE", // Add your intelligence
}

// Enhance tool detection
toolSignatures := []string{
    "selenium", "phantomjs", "headless",
    "burpsuite", "owasp-zap", "nmap",
    "YOUR_SIGNATURE", // Custom signatures
}</div>

        <h2>💡 Operational Best Practices</h2>

        <div class="success-box">
            <strong>Daily Operations:</strong>
            <ol>
                <li><strong>Morning Review:</strong> Check overnight security alerts</li>
                <li><strong>Pattern Analysis:</strong> Look for systematic investigation signs</li>
                <li><strong>Intelligence Updates:</strong> Add new LE IP ranges and domains</li>
                <li><strong>Customer Notifications:</strong> Alert customers of high-risk detections</li>
            </ol>
        </div>

        <div class="warning-box">
            <strong>Investigation Indicators:</strong>
            <ul>
                <li>Multiple government emails in short timeframe</li>
                <li>Systematic URL testing patterns</li>
                <li>Coordinated access from LE IP ranges</li>
                <li>Automated tool signatures in user agents</li>
            </ul>
        </div>

        <h2>🔒 OPSEC Guidelines</h2>

        <div class="danger-box">
            <strong>SECURITY REMINDERS:</strong><br>
            • Monitor admin endpoints for access attempts<br>
            • Use VPN when accessing victim monitoring data<br>
            • Rotate admin tokens regularly<br>
            • Keep law enforcement intelligence updated<br>
            • Document all high-risk victim interactions
        </div>

        <h2>🔗 Integration Points</h2>

        <table>
            <thead>
                <tr>
                    <th>System Component</th>
                    <th>Integration Function</th>
                    <th>Monitoring Level</th>
                    <th>Response Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>MITM Proxy</td>
                    <td>Anonymous tracking</td>
                    <td>IP/User-Agent</td>
                    <td>Initial assessment</td>
                </tr>
                <tr>
                    <td>Credential Capture</td>
                    <td>Email correlation</td>
                    <td>Full victim profile</td>
                    <td>Blocking decisions</td>
                </tr>
                <tr>
                    <td>Admin Dashboard</td>
                    <td>Real-time alerts</td>
                    <td>Security monitoring</td>
                    <td>Manual intervention</td>
                </tr>
                <tr>
                    <td>Customer Metrics</td>
                    <td>Performance data</td>
                    <td>Aggregate statistics</td>
                    <td>Business intelligence</td>
                </tr>
            </tbody>
        </table>

        <h2>📋 Quick Reference</h2>

        <div class="info-box">
            <strong>Key Endpoints:</strong><br>
            <code>GET /admin/security-alerts</code> - Real-time LE detection alerts<br>
            <code>GET /admin/customer-metrics</code> - Customer performance data<br>
            <code>GET /admin/link-performance</code> - Aggregate analytics<br><br>
            
            <strong>Global Access:</strong><br>
            <code>monitoring.GlobalVictimMonitor</code> - Use from any package<br><br>

            <strong>Core Functions:</strong><br>
            <code>TrackVictimActivity()</code> - Log victim interaction<br>
            <code>ShouldBlockVictim()</code> - Check blocking decision<br>
            <code>GetHighRiskVictims()</code> - Get security alerts
        </div>

        <div class="critical-box">
            <strong>⚠️ OPERATIONAL SECURITY REMINDER:</strong><br>
            This system is designed to protect against law enforcement investigation. Always ensure your usage complies with applicable laws and maintains proper operational security practices.
        </div>

        <h2>🔗 Related Documentation</h2>
        <ul>
            <li><a href="VICTIM_MONITORING_SYSTEM.md">Complete Technical Documentation</a> - Full system reference</li>
            <li><a href="admin-api.html">Admin API Reference</a> - All administrative endpoints</li>
            <li><a href="security-features.html">Security Features</a> - Overall security architecture</li>
            <li><a href="kill-switch.html">Kill Switch System</a> - Emergency response procedures</li>
        </ul>
    </div>
</body>
</html>
